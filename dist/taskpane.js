!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=307)}({307:function(e,t,n){"use strict";n.r(t);n(308),n(309),n(310);function r(e,t,n,r,a,s,o){try{var i=e[s](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,s){var o=e.apply(t,n);function i(e){r(o,a,s,i,l,"next",e)}function l(e){r(o,a,s,i,l,"throw",e)}i(void 0)}))}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,s=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw s}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(){$("#templates").prop("disabled",!0).css("background-size","auto");var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState)if(JSON.parse(e.response).result){$("#templates").prop("disabled",!1).css("background-size","0%").find("option").remove().end();for(var t=0,n=Object.entries(JSON.parse(e.response).data);t<n.length;t++){var r=s(n[t],2),a=r[0],o=r[1];$("#templates").append('<option value="'+a+'">'+o+"</option>")}}else u("Authentication token expired. Please login again.","danger"),setTimeout((function(){g()}),1e3)},e.open("GET",window.localStorage.getItem("serverSettings")+"b/system/v3/letter/get_letter_details"),e.setRequestHeader("authorisation",window.localStorage.getItem("token")),e.setRequestHeader("Accept","application/json, text/plain, */*"),e.send()}function l(){$("#letters").prop("disabled",!0).css("background-size","auto");var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState)if(JSON.parse(e.response).result){$("#letters").prop("disabled",!1).css("background-size","0%").find("option").remove().end();for(var t=0,n=Object.entries(JSON.parse(e.response).data);t<n.length;t++){var r=s(n[t],2),a=r[0],o=r[1];$("#letters").append('<option value="'+a+'">'+o+"</option>")}}else u("Authentication token expired. Please login again.","danger"),setTimeout((function(){g()}),1e3)},e.open("GET",window.localStorage.getItem("serverSettings")+"b/system/v3/letter/get_letter_details"),e.setRequestHeader("authorisation",window.localStorage.getItem("token")),e.setRequestHeader("Accept","application/json, text/plain, */*"),e.send()}function p(){$("#fetchServers").empty().append('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Fetching Servers...').prop("disabled",!0),$("#subDomain").prop("disabled",!0),$("#serverSettings").css("background-size","auto");var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState){$("#fetchServers").empty().append("Fetch Servers").prop("disabled",!1),$("#serverSettings").prop("disabled",!1),$("#serverSettings").css("background-size","0%");var t=JSON.parse(JSON.parse(e.response).data[0].server_settings);$("#serverSettings").find("option").remove().end(),$("#serverSettings").append("<option>"+t.staging.url+"</option>"),$("#serverSettings").append("<option>"+t.production.url+"</option>")}},e.open("GET","https://lateral1.com/getServerSettings.php?code="+$("#subDomain").val()),e.send()}function c(){return d.apply(this,arguments)}function d(){return(d=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=a(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=$("#variables").find(":selected").text(),t.document.getSelection().insertText("{"+n+"}",Word.InsertLocation.end),e.next=4,t.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t){document.getElementById("status").innerHTML='<div class="alert alert-'+t+' alert-dismissible fade show" role="alert">'+e+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'}function f(e){Office.context.document.getFileAsync("compressed",{sliceSize:4e6},(function(t){if(t.status==Office.AsyncResultStatus.Succeeded){var n=t.value,r={file:n,counter:0,sliceCount:n.sliceCount,type:e};u("Getting file of "+n.size+" bytes","success"),m(r)}else u(t.status,"danger")}))}function m(e){e.file.getSliceAsync(e.counter,(function(t){t.status==Office.AsyncResultStatus.Succeeded?(u("Sending piece "+(e.counter+1)+" of "+e.sliceCount,"success"),function(e,t){var n=e.data;if(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){var n=JSON.parse(r.response);n.result?(u("Sent "+e.size+" bytes.","success"),t.counter++,t.counter<t.sliceCount?(n.filename?(t.filename=n.filename,u("file name:"+n.filename,"success")):u("file not created.","danger"),m(t)):(!function(e){e.file.closeAsync((function(e){"succeeded"==e.status?(i(),l(),u("File saved to the server successfully.","success")):u("File couldn't be saved to the server.","danger")}))}(t),$("#saveTemplateToServer").empty().append("Save to Server").prop("disabled",!1),$("#saveLetterToServer").empty().append("Save to Server").prop("disabled",!1))):u(n.message,"danger")}};var a=new FormData;if(a.append("letter_data",n),a.append("max_slice",t.sliceCount),a.append("slice_no",t.counter+1),"template"===t.type){var s=$("#templates").find(":selected").val();$("#templateName").val()?a.append("letter_name",$("#templateName").val()):a.append("letter_id",s)}else a.append("letter_id",$("#letters").find(":selected").val()),a.append("case_id",$("#caseId").val());t.filename&&a.append("file_name",t.filename),r.open("POST",window.localStorage.getItem("serverSettings")+"b/system/v3/"+t.type+"/create"),r.setRequestHeader("authorisation",window.localStorage.getItem("token")),r.setRequestHeader("Accept","application/json, text/plain, */*"),r.send(a)}}(t.value,e)):u(t.status,"danger")}))}function v(){$("#login").empty().append('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Authenticating...').prop("disabled",!0),$("#subDomain").prop("disabled",!0);var e=new XMLHttpRequest;e.onreadystatechange=function(){var t;4==e.readyState&&($("#login").empty().append("Login").prop("disabled",!1),JSON.parse(e.response).result?(t=JSON.parse(e.response).data,window.localStorage.setItem("token",t.remote_token),window.localStorage.setItem("name",t.name),window.localStorage.setItem("serverSettings",$("#serverSettings").val()),Office.context.document.settings.saveAsync((function(e){e.status==Office.AsyncResultStatus.Failed?u(e.error.message,"danger"):u("Settings saved.","success")})),location.reload(),b(),u("Login successful","success")):u(JSON.parse(e.response).message,"danger"))};var t=new FormData;t.append("username",$("#username").val()),t.append("password",$("#password").val()),e.open("POST",$("#serverSettings").val()+"b/system/v1/session/login"),e.setRequestHeader("Accept","application/json, text/plain, */*"),e.send(t)}function g(){window.localStorage.removeItem("token"),window.localStorage.removeItem("name"),window.localStorage.removeItem("serverSettings"),Office.context.document.settings.saveAsync((function(e){e.status==Office.AsyncResultStatus.Failed?u(e.error.message,"danger"):(b(),u("Logout successful.","success"))}))}function b(){window.localStorage.getItem("token")?($("#helloUser").text("Hello "+window.localStorage.getItem("name")+"!"),$("#mainContent").show(),$("#formLogin").hide(),$("#logoutDiv").show()):($("#helloUser").text(""),$("#mainContent").hide(),$("#logoutDiv").hide(),$("#formLogin").show())}function y(){$("#serverSettings").val()&&$("#username").val()&&$("#password").val()?$("#login").prop("disabled",!1):$("#login").prop("disabled",!0)}function S(){$("#fromExistingTemplate").prop("checked")||$("#templateName").val()?$("#saveTemplateToServer").prop("disabled",!1):$("#saveTemplateToServer").prop("disabled",!0)}function h(){$("#caseId").val()&&$("#letters").val()?($("#saveLetterToServer").prop("disabled",!1),$("#loadLetter").prop("disabled",!1)):($("#saveLetterToServer").prop("disabled",!0),$("#loadLetter").prop("disabled",!0))}function w(){$("#subDomain").val()?$("#fetchServers").prop("disabled",!1):$("#fetchServers").prop("disabled",!0)}function x(){return T.apply(this,arguments)}function T(){return(T=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $("#loadLetter").empty().append('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...').prop("disabled",!0),e.abrupt("return",Word.run(function(){var e=a(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k($("#letters").find(":selected").val(),$("#caseId").val());case 2:return n=e.sent,t.document.body.insertFileFromBase64(n,Word.InsertLocation.replace),e.next=6,t.sync();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return O.apply(this,arguments)}function O(){return(O=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $("#loadTemplate").empty().append('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...').prop("disabled",!0),e.abrupt("return",Word.run(function(){var e=a(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k($("#templates").find(":selected").val());case 2:return n=e.sent,t.document.body.insertFileFromBase64(n,Word.InsertLocation.replace),e.next=6,t.sync();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState){t?$("#loadLetter").empty().append("Load").prop("disabled",!1):$("#loadTemplate").empty().append("Load").prop("disabled",!1);var e=JSON.parse(a.response);e.result?n(e.data):(u(e.message,"danger"),r(a.status))}};var s=window.localStorage.getItem("serverSettings")+"b/system/v3/template/load_template?template_id="+e;t&&(s=s+"&caseid="+t),a.open("GET",s),a.setRequestHeader("authorisation",window.localStorage.getItem("token")),a.setRequestHeader("Accept","application/json, text/plain, */*"),a.send()}))}Office.onReady((function(e){e.host===Office.HostType.Word&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",$('[data-toggle="tooltip"]').tooltip(),$("#serverSettings").prop("disabled",!0),y(),w(),S(),h(),b(),i(),l(),function(){$("#variables").prop("disabled",!0),$("#variables").css("background-size","auto");var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState)if(JSON.parse(e.response).result){$("#variables").prop("disabled",!1),$("#variables").css("background-size","0%"),$("#variables").find("option").remove().end();for(var t=0,n=Object.entries(JSON.parse(e.response).data.letter_variables_list);t<n.length;t++){var r=s(n[t],2),a=r[0],o=r[1];$("#variables").append('<option value="'+a+'">'+o+"</option>")}}else u("Authentication token expired. Please login again.","danger"),setTimeout((function(){g()}),1e3)},e.open("GET",window.localStorage.getItem("serverSettings")+"b/system/v3/letter/get_variable_list"),e.setRequestHeader("authorisation",window.localStorage.getItem("token")),e.setRequestHeader("Accept","application/json, text/plain, */*"),e.send()}(),document.getElementById("addVariable").onclick=c,document.getElementById("login").onclick=v,document.getElementById("logout").onclick=g,document.getElementById("fetchServers").onclick=p,document.getElementById("loadLetter").onclick=x,document.getElementById("loadTemplate").onclick=I,$("#saveTemplateToServer").click((function(){$("#saveTemplateToServer").empty().append('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Saving to Server...').prop("disabled",!0),f("template")})),$("#saveLetterToServer").click((function(){$("#saveLetterToServer").empty().append('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Saving to Server...').prop("disabled",!0),f("letter")})),$("#letters").change((function(){h()})),$("#serverSettings").change((function(){y()})),$("#templateName").blur((function(){S()})),$("#caseId").blur((function(){h()})),$("#username").blur((function(){y()})),$("#password").blur((function(){y()})),$("#subDomain").change((function(){w()})),$("#fromExistingTemplate").change((function(){S(),$(this).prop("checked")?($("#templateName").val(""),$("#templateNameDiv").hide(),$("#selectTemplateDiv").show(),$("#loadTemplate").show()):($("#selectTemplateDiv").hide(),$("#loadTemplate").hide(),$("#templateNameDiv").show())})))}))},308:function(e,t,n){e.exports=n.p+"assets/lateral_logo_16.png"},309:function(e,t,n){e.exports=n.p+"assets/lateral_logo_32.png"},310:function(e,t,n){e.exports=n.p+"assets/lateral_logo_80.png"}});
//# sourceMappingURL=taskpane.js.map